<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
  <meta name="generator" content="Hugo 0.88.1">
  <title>라임</title>


  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.min.css">

  <link href="https://hangeul.pstatic.net/hangeul_static/css/nanum-gothic.css" rel="stylesheet">
  <link href="https://hangeul.pstatic.net/hangeul_static/css/nanum-barun-gothic.css" rel="stylesheet">

  <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }
  </style>


  <!-- Custom styles for this template -->
  <!-- <link rel="stylesheet" href="../header/user/u-adminHeader.css"> -->
  <link href="social_match.css" rel="stylesheet">

  <script src="../node_modules/jquery/dist/jquery.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function () {
      $("#x-header").load("/header/user/header.html");  //헤더 인클루드
      $("#x-footer").load("/footer/footer.html");
    });
  </script>

  <script src="../common/selectCity.js"></script>

</head>

<body>

  <div id="x-header" class="d-flex bd-highlight mb-3"></div>

  <main class="social-match my-5">

    <div class="d-flex justify-content-between mb-3">
      <div class="d-flex w-100">
        <select class="form-select" aria-label="region" name="" id="drop-region">
          <option selected>지역</option>
          <!-- <option value="1">모든 지역</option>
          <option value="2">서울</option>
          <option value="3">경기/강원</option>
          <option value="4">인천</option>
          <option value="5">대전/세종/충청</option>
          <option value="6">대구/경북</option>
          <option value="7">부산/울산/경남</option>
          <option value="8">광주/전라</option>
          <option value="9">제주</option> -->
        </select>
        <select class="form-select" aria-label="city" name="" id="drop-city">
          <option selected>도시</option>
          <!-- <option value="1">서귀포시</option> -->
        </select>
        <select class="form-select" aria-label="level" name="category" id="levelNo">
          <option selected>레벨</option>
          <option value="1">모든 레벨</option>
          <option value="2">BEGINNER</option>
          <option value="3">INTERMEDIATE</option>
          <option value="4">ADVANCED</option>
          <option value="5">PRO</option>
        </select>
        <select class="form-select" aria-label="gender" name="category" id="matchTypeNo">
          <option value="-1" selected>성별</option>
          <option value="1">남자</option>
          <option value="2">여자</option>
          <option value="3">남녀모두</option>
        </select>
        <select class="form-select" aria-label="court-type" name="category" id="courtTypeNo">
          <option selected>코트</option>
          <option value="1">하드</option>
          <option value="2">클레이</option>
          <option value="3">잔디</option>
          <option value="4">앙투카</option>
        </select>
      </div>
      <div id="my-preferred">
        <input type="checkbox" value="" id="my-preferred-checkbox" class="form-check-input">
        <!-- &nbsp;&nbsp;내 선호 -->
        <span>&nbsp;&nbsp;내 선호</span>
      </div>
      <!-- <select class="form-select" aria-label="my-preferred" name="" id="preferred">
        <option selected>내 선호</option>
      </select> -->
    </div>

    <ul class="list-group list-group-flush match-list">

    </ul>


  </main>

  <div id="x-footer"></div>

  <!-- <script id="tr-template" type="text/x-handlebars-template">
  {{#each this}}
    <tr>
      <td>{{no}}</td>
      <td><a href="view.html?no={{no}}">{{name}}</a></td>
      <td>{{email}}</td>
      <td>{{tels.[0].tel}}</td>
      <td>{{company}}</td>
    </tr>
  {{/each}}
  </script> -->

  <script src="../node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../node_modules/handlebars/dist/handlebars.min.js"></script>
  <script src="../node_modules/jquery/dist/jquery.min.js"></script>
  <script type="text/javascript">
    "use strict"
    $(document).ready(function () {
      $.getJSON("http://localhost:8080/match/list", function (arr) {
        console.log(arr)
        matchArr = [];
        const matchList = $(".match-list")
        let str = ''
        for (let i = 0; i < arr.length; i++) {
          let state = ''
          let aaa = ''
          if (arr[i].state === 'A') {
            state = '신청 가능'
          } else {
            state = '마감'
            aaa = 'closed-btn'
          }
          /*let matchType = ''
          if (arr[i].matchTypeNo === 1) {
            matchType = '남자'
          } else if (arr[i].matchTypeNo === 2) {
            matchType = '여자'
          } else {
            matchType = '혼성'
          }*/
          str += `
          <a href="/social_match/social_match_3.html" class="list-group-item list-group-item-action">
            <div class="d-flex w-100 justify-content-between align-items-center">
              <div>
                <div class="d-flex justify-content-start align-items-center">
                  <div class="me-4 match-time">${arr[i].startTime.slice(0, 5)}</div>
                  <div class="ms-1">
                    <h6 class="mb-1">${arr[i].court.field.name} ${arr[i].court.name}</h6>
                    <p class="text-muted match-info">${checkMatchType(arr[i].matchTypeNo)} · ${checkNumOfPeople(arr[i].numOfPeople)} · ${checkCourtType(arr[i].court.courtTypeNo)} · ${checkLevel(arr[i].levelNo)}</p>
                  </div>
                </div>
              </div>
              <button class="btn match-btn ${aaa}">${state}</button>
              </div>
            </a>`
        }
        $(".match-list").html(str)
      })
    })

    // import { selectCity } from '../common/selectCity.js'

    // const dropResion = $("#drop-region")
    // const infoBtn = $('.info-btn')
    // const dropCity = $('#drop-city')

    // dropResion.on('change', function (e) {
    //   selectCity(dropResion.val());
    // })

    function checkMatchType(matchTypeNo) {
      switch (matchTypeNo) {
        case 1: return '남자'
        case 2: return '여자'
        case 3: return '혼성'
      }
    }

    function checkNumOfPeople(numOfPeople) {
      switch (numOfPeople) {
        case 'S': return '1vs1'
        case 'D': return '2vs2'
      }
    }


    function checkLevel(level) {
      switch (level) {
        case 1: return '모든 레벨'
        case 2: return 'BEGINNER'
        case 3: return 'INTERMEDIATE'
        case 4: return 'ADVANCED'
        case 5: return 'PRO'
      }
    }

    function checkCourtType(courtTypeNo) {
      switch (courtTypeNo) {
        case 1: return '하드'
        case 2: return '클레이'
        case 3: return '잔디'
        case 4: return '앙투카'
      }
    }

    console.log(checkCourtType(4))

    let matchArr;

    $("select[name='category']").on("change", function (e) {
      const category = $(e.target).closest("select").attr("id")
      console.log(category)
      const idx = e.target.value
      console.log(idx)

      if (idx < 0) {
        return
      }

      $.getJSON("http://localhost:8080/match/list", function (arr) {
        const matchList = $(".match-list")
        let str = ''
        for (let i = 0; i < arr.length; i++) {
          if (arr[i].matchTypeNo == idx) {
            matchArr.push(arr[i]);
            let state = ''
            let aaa = ''
            if (arr[i].state === 'A') {
              state = '신청 가능'
            } else {
              state = '마감'
              aaa = 'closed-btn'
            }
            str += `
            <a href="/social_match/social_match_3.html" class="list-group-item list-group-item-action">
              <div class="d-flex w-100 justify-content-between align-items-center">
                <div>
                  <div class="d-flex justify-content-start align-items-center">
                    <div class="me-4 match-time">${arr[i].startTime.slice(0, 5)}</div>
                    <div class="ms-1">
                      <h6 class="mb-1">${arr[i].court.field.name} ${arr[i].court.name}</h6>
                      <p class="text-muted match-info">${checkMatchType(arr[i].matchTypeNo)} · ${checkNumOfPeople(arr[i].numOfPeople)} · ${checkCourtType(arr[i].court.courtTypeNo)} · ${checkLevel(arr[i].levelNo)}</p>
                    </div>
                  </div>
                </div>
                <button class="btn match-btn ${aaa}">${state}</button>
                </div>
              </a>`
          }
        }
        $(".match-list").html(str)
        console.log(matchArr)
      })

      // $(".match-list").html('')
      // storeService.loadJson(idx, makeStores)
    })


  </script>

</body>

</html>