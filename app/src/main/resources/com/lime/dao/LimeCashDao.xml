<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.lime.dao.LimeCashDao">

<resultMap type="LimeCash" id="cashMap"></resultMap>

<insert id="insert" parameterType="LimeCash" keyProperty="limeId" keyColumn="lime_id" useGeneratedKeys="true">
    INSERT INTO lime_cash(user_id, amt, type_use)
    VALUE       (#{userId},#{amt},#{typeUse})
</insert>


<insert id="checkout" parameterType="LimeCash" keyProperty="limeId" keyColumn="lime_id" useGeneratedKeys="true">
    INSERT INTO lime_cash(user_id, amt, type_use)
    VALUE       (#{userId},#{amt},#{typeUse})
</insert>


<select id="findCash" parameterType="int" resultType="int">
    SELECT sum(A.cal_amt)
    FROM
    (SELECT CASE
            WHEN type_use='C'
            THEN amt
            WHEN type_use='U'
            THEN -amt
            ELSE 0
            END AS cal_amt
    FROM    lime_cash
    WHERE   user_id=#{userId}) AS A
</select>


</mapper>